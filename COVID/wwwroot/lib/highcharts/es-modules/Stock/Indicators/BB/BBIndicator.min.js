"use strict";var __extends=this&&this.__extends||function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();import MultipleLinesMixin from"../../../Mixins/MultipleLines.js";import SeriesRegistry from"../../../Core/Series/SeriesRegistry.js";var SMAIndicator=SeriesRegistry.seriesTypes.sma;import U from"../../../Core/Utilities.js";var extend=U.extend,isArray=U.isArray,merge=U.merge;function getStandardDeviation(t,e,i,o){for(var r,n=0,a=t.length,s=0;s<a;s++)n+=(r=(i?t[s][e]:t[s])-o)*r;return n/=a-1,Math.sqrt(n)}var BBIndicator=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=void 0,t.options=void 0,t.points=void 0,t}return __extends(t,e),t.prototype.init=function(){SeriesRegistry.seriesTypes.sma.prototype.init.apply(this,arguments),this.options=merge({topLine:{styles:{lineColor:this.color}},bottomLine:{styles:{lineColor:this.color}}},this.options)},t.prototype.getValues=function(t,e){var i,o,r,n,a,s,p=e.period,l=e.standardDeviation,d=t.xData,u=t.yData,y=u?u.length:0,c=[],m=[],f=[];if(!(d.length<p)){for(n=isArray(u[0]),s=p;s<=y;s++)o=d.slice(s-p,s),r=u.slice(s-p,s),i=(a=SeriesRegistry.seriesTypes.sma.prototype.getValues.call(this,{xData:o,yData:r},e)).xData[0],o=a.yData[0],a=getStandardDeviation(r,e.index,n,o),c.push([i,r=o+l*a,o,a=o-l*a]),m.push(i),f.push([r,o,a]);return{values:c,xData:m,yData:f}}},t.defaultOptions=merge(SMAIndicator.defaultOptions,{params:{period:20,standardDeviation:2,index:3},bottomLine:{styles:{lineWidth:1,lineColor:void 0}},topLine:{styles:{lineWidth:1,lineColor:void 0}},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span><b> {series.name}</b><br/>Top: {point.top}<br/>Middle: {point.middle}<br/>Bottom: {point.bottom}<br/>'},marker:{enabled:!1},dataGrouping:{approximation:"averages"}}),t}(SMAIndicator);extend(BBIndicator.prototype,{pointArrayMap:["top","middle","bottom"],pointValKey:"middle",nameComponents:["period","standardDeviation"],linesApiNames:["topLine","bottomLine"],drawGraph:MultipleLinesMixin.drawGraph,getTranslatedLinesNames:MultipleLinesMixin.getTranslatedLinesNames,translate:MultipleLinesMixin.translate,toYData:MultipleLinesMixin.toYData}),SeriesRegistry.registerSeriesType("bb",BBIndicator);export default BBIndicator;