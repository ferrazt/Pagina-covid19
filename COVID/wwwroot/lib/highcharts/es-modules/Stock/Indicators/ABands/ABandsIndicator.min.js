"use strict";var __extends=this&&this.__extends||function(){var a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();import MultipleLinesMixin from"../../../Mixins/MultipleLines.js";import SeriesRegistry from"../../../Core/Series/SeriesRegistry.js";var SMAIndicator=SeriesRegistry.seriesTypes.sma;import U from"../../../Core/Utilities.js";var correctFloat=U.correctFloat,extend=U.extend,merge=U.merge;function getBaseForBand(t,e,i){return correctFloat(e-t)/(correctFloat(e+t)/2)*1e3*i}function getPointUB(t,e){return t*correctFloat(1+2*e)}function getPointLB(t,e){return t*correctFloat(1-2*e)}var ABandsIndicator=function(h){function t(){var t=null!==h&&h.apply(this,arguments)||this;return t.data=void 0,t.options=void 0,t.points=void 0,t}return __extends(t,h),t.prototype.getValues=function(t,e){var i,a,r,o,n,s=e.period,p=e.factor,l=e.index,c=t.xData,d=t.yData,u=d?d.length:0,y=[],f=[],g=[],m=[],x=[];if(!(u<s)){for(n=0;n<=u;n++)n<u&&(a=getBaseForBand(d[n][2],d[n][1],p),y.push(getPointUB(d[n][1],a)),f.push(getPointLB(d[n][2],a))),s<=n&&(r=c.slice(n-s,n),o=d.slice(n-s,n),i=h.prototype.getValues.call(this,{xData:r,yData:y.slice(n-s,n)},{period:s}),a=h.prototype.getValues.call(this,{xData:r,yData:f.slice(n-s,n)},{period:s}),o=(r=h.prototype.getValues.call(this,{xData:r,yData:o},{period:s,index:l})).xData[0],i=i.yData[0],a=a.yData[0],r=r.yData[0],g.push([o,i,r,a]),m.push(o),x.push([i,r,a]));return{values:g,xData:m,yData:x}}},t.defaultOptions=merge(SMAIndicator.defaultOptions,{params:{period:20,factor:.001,index:3},lineWidth:1,topLine:{styles:{lineWidth:1}},bottomLine:{styles:{lineWidth:1}},dataGrouping:{approximation:"averages"}}),t}(SMAIndicator);extend(ABandsIndicator.prototype,{drawGraph:MultipleLinesMixin.drawGraph,getTranslatedLinesNames:MultipleLinesMixin.getTranslatedLinesNames,linesApiNames:["topLine","bottomLine"],nameBase:"Acceleration Bands",nameComponents:["period","factor"],pointArrayMap:["top","middle","bottom"],pointValKey:"middle",toYData:MultipleLinesMixin.toYData,translate:MultipleLinesMixin.translate}),SeriesRegistry.registerSeriesType("abands",ABandsIndicator);export default ABandsIndicator;