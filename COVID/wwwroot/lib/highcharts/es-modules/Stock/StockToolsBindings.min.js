"use strict";import H from"../Core/Globals.js";import NavigationBindings from"../Extensions/Annotations/NavigationBindings.js";import D from"../Core/DefaultOptions.js";var getOptions=D.getOptions,setOptions=D.setOptions;import Series from"../Core/Series/Series.js";import U from"../Core/Utilities.js";import palette from"../Core/Color/Palette.js";var correctFloat=U.correctFloat,defined=U.defined,extend=U.extend,fireEvent=U.fireEvent,isNumber=U.isNumber,merge=U.merge,pick=U.pick,uniqueKey=U.uniqueKey,bindingsUtils=NavigationBindings.prototype.utils,PREFIX="highcharts-";bindingsUtils.addFlagFromForm=function(r){return function(t){var i,s=this,n=s.chart,e=n.stockTools,o=bindingsUtils.getFieldType,a=bindingsUtils.attractToPoint(t,n);a&&(t={x:a.x,y:a.y},i={type:"flags",onSeries:a.series.id,shape:r,data:[t],xAxis:a.xAxis,yAxis:a.yAxis,point:{events:{click:function(){var i=this,t=i.options;fireEvent(s,"showPopup",{point:i,formType:"annotation-toolbar",options:{langKey:"flags",type:"flags",title:[t.title,o(t.title)],name:[t.name,o(t.name)]},onSubmit:function(t){"remove"===t.actionType?i.remove():i.update(s.fieldsToOptions(t.fields,{}))}})}}}},e&&e.guiEnabled||n.addSeries(i),fireEvent(s,"showPopup",{formType:"flag",options:{langKey:"flags",type:"flags",title:["A",o("A")],name:["Flag A",o("Flag A")]},onSubmit:function(t){s.fieldsToOptions(t.fields,i.data[0]),n.addSeries(i)}}))}},bindingsUtils.manageIndicators=function(t){var i,s,n,e=this,o=e.chart,a={linkedTo:t.linkedTo,type:t.type},r=["ad","atr","cci","cmf","disparityindex","cmo","dmi","macd","mfi","roc","rsi","ao","aroon","aroonoscillator","trix","apo","dpo","ppo","natr","obv","williamsr","stochastic","slowstochastic","linearRegression","linearRegressionSlope","linearRegressionIntercept","linearRegressionAngle","klinger"];"edit"===t.actionType?(e.fieldsToOptions(t.fields,a),(n=o.get(t.seriesId))&&n.update(a,!1)):"remove"===t.actionType?(n=o.get(t.seriesId))&&(s=n.yAxis,n.linkedSeries&&n.linkedSeries.forEach(function(t){t.remove(!1)}),n.remove(!1),0<=r.indexOf(n.type)&&(i=s.options.height,s.remove(!1),e.resizeYAxes(i))):(a.id=uniqueKey(),e.fieldsToOptions(t.fields,a),n=o.get(a.linkedTo),i=getOptions().plotOptions,void 0!==n&&n instanceof Series&&"sum"===n.getDGApproximation()&&!defined(i&&i[a.type]&&i.dataGrouping&&i.dataGrouping.approximation)&&(a.dataGrouping={approximation:"sum"}),0<=r.indexOf(t.type)?(s=o.addAxis({id:uniqueKey(),offset:0,opposite:!0,title:{text:""},tickPixelInterval:40,showLastLabel:!1,labels:{align:"left",y:-2}},!1,!1),a.yAxis=s.options.id,e.resizeYAxes()):a.yAxis=o.get(t.linkedTo).options.yAxis,0<=["ad","cmf","klinger","mfi","obv","vbp","vwap"].indexOf(t.type)&&(a.params.volumeSeriesID=o.series.filter(function(t){return"column"===t.options.type})[0].options.id),o.addSeries(a,!1)),fireEvent(e,"deselectButton",{button:e.selectedButtonElement}),o.redraw()},bindingsUtils.updateHeight=function(t,i){t=this.utils.getAssignedAxis(this.chart.pointer.getCoordinates(t).yAxis);t&&i.update({typeOptions:{height:t.value-i.options.typeOptions.points[1].y}})},bindingsUtils.attractToPoint=function(t,i){var s,n,e,o,t=i.pointer.getCoordinates(t),a=Number.MAX_VALUE;if(i.navigationBindings&&(o=i.navigationBindings.utils.getAssignedAxis(t.xAxis),s=i.navigationBindings.utils.getAssignedAxis(t.yAxis)),o&&s)return e=o.value,o=s.value,s.axis.series.forEach(function(t){t.points&&t.points.forEach(function(t){t&&a>Math.abs(t.x-e)&&(a=Math.abs(t.x-e),n=t)})}),n&&n.x&&n.y?{x:n.x,y:n.y,below:o<n.y,series:n.series,xAxis:n.series.xAxis.options.index||0,yAxis:n.series.yAxis.options.index||0}:void 0},bindingsUtils.isNotNavigatorYAxis=function(t){return t.userOptions.className!==PREFIX+"navigator-yaxis"},bindingsUtils.isPriceIndicatorEnabled=function(t){return t.some(function(t){return t.lastVisiblePrice||t.lastPrice})},bindingsUtils.updateNthPoint=function(o){return function(t,i){var s=i.options.typeOptions,t=this.chart.pointer.getCoordinates(t),n=this.utils.getAssignedAxis(t.xAxis),e=this.utils.getAssignedAxis(t.yAxis);n&&e&&(s.points.forEach(function(t,i){o<=i&&(t.x=n.value,t.y=e.value)}),i.update({typeOptions:{points:s.points}}))}},extend(NavigationBindings.prototype,{getYAxisPositions:function(n,e,o,t){var a,r,l=0;function p(t){return defined(t)&&!isNumber(t)&&t.match("%")}return t&&(r=correctFloat(parseFloat(t)/100)),{positions:n.map(function(t,i){var s=correctFloat(p(t.options.height)?parseFloat(t.options.height)/100:t.height/e),t=correctFloat(p(t.options.top)?parseFloat(t.options.top)/100:(t.top-t.chart.plotTop)/e);return l=r?t<=l?correctFloat(Math.max(l,(t||0)+(s||0))):(t=correctFloat(t-r),correctFloat(l+s)):(isNumber(s)||(s=n[i-1].series.every(function(t){return t.is("sma")})?a:o/100),isNumber(t)||(t=l),a=s,correctFloat(Math.max(l,(t||0)+(s||0)))),{height:100*s,top:100*t}}),allAxesHeight:l}},getYAxisResizers:function(n){var e=[];return n.forEach(function(t,i){var s=n[i+1];e[i]=s?{enabled:!0,controlledAxis:{next:[pick(s.options.id,s.options.index)]}}:{enabled:!1}}),e},resizeYAxes:function(t){var i=this.chart,s=i.yAxis.filter(bindingsUtils.isNotNavigatorYAxis),n=i.plotHeight,i=this.getYAxisPositions(s,n,20,t),n=i.positions,e=i.allAxesHeight,o=this.getYAxisResizers(s);!t&&e<=correctFloat(1)?n[n.length-1]={height:20,top:correctFloat(100*e-20)}:n.forEach(function(t){t.height=t.height/(100*e)*100,t.top=t.top/(100*e)*100}),n.forEach(function(t,i){s[i].update({height:t.height+"%",top:t.top+"%",resize:o[i],offset:0},!1)})},recalculateYAxisPositions:function(s,n,e,o){return s.forEach(function(t,i){i=s[i-1];t.top=i?correctFloat(i.height+i.top):0,e&&(t.height=correctFloat(t.height+o*n))}),s}});var stockToolsBindings={segment:{className:"highcharts-segment",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),t=this.utils.getAssignedAxis(i.yAxis),i=this.chart.options.navigation;if(s&&t)return i=merge({langKey:"segment",type:"crookedLine",typeOptions:{xAxis:s.axis.options.index,yAxis:t.axis.options.index,points:[{x:s.value,y:t.value},{x:s.value,y:t.value}]}},i.annotationsOptions,i.bindings.segment.annotationsOptions),this.chart.addAnnotation(i)},steps:[bindingsUtils.updateNthPoint(1)]},arrowSegment:{className:"highcharts-arrow-segment",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),t=this.utils.getAssignedAxis(i.yAxis),i=this.chart.options.navigation;if(s&&t)return i=merge({langKey:"arrowSegment",type:"crookedLine",typeOptions:{line:{markerEnd:"arrow"},xAxis:s.axis.options.index,yAxis:t.axis.options.index,points:[{x:s.value,y:t.value},{x:s.value,y:t.value}]}},i.annotationsOptions,i.bindings.arrowSegment.annotationsOptions),this.chart.addAnnotation(i)},steps:[bindingsUtils.updateNthPoint(1)]},ray:{className:"highcharts-ray",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),t=this.utils.getAssignedAxis(i.yAxis),i=this.chart.options.navigation;if(s&&t)return i=merge({langKey:"ray",type:"infinityLine",typeOptions:{type:"ray",xAxis:s.axis.options.index,yAxis:t.axis.options.index,points:[{x:s.value,y:t.value},{x:s.value,y:t.value}]}},i.annotationsOptions,i.bindings.ray.annotationsOptions),this.chart.addAnnotation(i)},steps:[bindingsUtils.updateNthPoint(1)]},arrowRay:{className:"highcharts-arrow-ray",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),t=this.utils.getAssignedAxis(i.yAxis),i=this.chart.options.navigation;if(s&&t)return i=merge({langKey:"arrowRay",type:"infinityLine",typeOptions:{type:"ray",line:{markerEnd:"arrow"},xAxis:s.axis.options.index,yAxis:t.axis.options.index,points:[{x:s.value,y:t.value},{x:s.value,y:t.value}]}},i.annotationsOptions,i.bindings.arrowRay.annotationsOptions),this.chart.addAnnotation(i)},steps:[bindingsUtils.updateNthPoint(1)]},infinityLine:{className:"highcharts-infinity-line",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),t=this.utils.getAssignedAxis(i.yAxis),i=this.chart.options.navigation;if(s&&t)return i=merge({langKey:"infinityLine",type:"infinityLine",typeOptions:{type:"line",xAxis:s.axis.options.index,yAxis:t.axis.options.index,points:[{x:s.value,y:t.value},{x:s.value,y:t.value}]}},i.annotationsOptions,i.bindings.infinityLine.annotationsOptions),this.chart.addAnnotation(i)},steps:[bindingsUtils.updateNthPoint(1)]},arrowInfinityLine:{className:"highcharts-arrow-infinity-line",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),t=this.utils.getAssignedAxis(i.yAxis),i=this.chart.options.navigation;if(s&&t)return i=merge({langKey:"arrowInfinityLine",type:"infinityLine",typeOptions:{type:"line",line:{markerEnd:"arrow"},xAxis:s.axis.options.index,yAxis:t.axis.options.index,points:[{x:s.value,y:t.value},{x:s.value,y:t.value}]}},i.annotationsOptions,i.bindings.arrowInfinityLine.annotationsOptions),this.chart.addAnnotation(i)},steps:[bindingsUtils.updateNthPoint(1)]},horizontalLine:{className:"highcharts-horizontal-line",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),t=this.utils.getAssignedAxis(i.yAxis),i=this.chart.options.navigation;s&&t&&(i=merge({langKey:"horizontalLine",type:"infinityLine",draggable:"y",typeOptions:{type:"horizontalLine",xAxis:s.axis.options.index,yAxis:t.axis.options.index,points:[{x:s.value,y:t.value}]}},i.annotationsOptions,i.bindings.horizontalLine.annotationsOptions),this.chart.addAnnotation(i))}},verticalLine:{className:"highcharts-vertical-line",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),t=this.utils.getAssignedAxis(i.yAxis),i=this.chart.options.navigation;s&&t&&(i=merge({langKey:"verticalLine",type:"infinityLine",draggable:"x",typeOptions:{type:"verticalLine",xAxis:s.axis.options.index,yAxis:t.axis.options.index,points:[{x:s.value,y:t.value}]}},i.annotationsOptions,i.bindings.verticalLine.annotationsOptions),this.chart.addAnnotation(i))}},crooked3:{className:"highcharts-crooked3",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),n=this.utils.getAssignedAxis(i.yAxis);if(s&&n){var e=s.value,t=n.value,i=this.chart.options.navigation,i=merge({langKey:"crooked3",type:"crookedLine",typeOptions:{xAxis:s.axis.options.index,yAxis:n.axis.options.index,points:[{x:e,y:t},{x:e,y:t},{x:e,y:t}]}},i.annotationsOptions,i.bindings.crooked3.annotationsOptions);return this.chart.addAnnotation(i)}},steps:[bindingsUtils.updateNthPoint(1),bindingsUtils.updateNthPoint(2)]},crooked5:{className:"highcharts-crooked5",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),n=this.utils.getAssignedAxis(i.yAxis);if(s&&n){var e=s.value,t=n.value,i=this.chart.options.navigation,i=merge({langKey:"crookedLine",type:"crookedLine",typeOptions:{xAxis:s.axis.options.index,yAxis:n.axis.options.index,points:[{x:e,y:t},{x:e,y:t},{x:e,y:t},{x:e,y:t},{x:e,y:t}]}},i.annotationsOptions,i.bindings.crooked5.annotationsOptions);return this.chart.addAnnotation(i)}},steps:[bindingsUtils.updateNthPoint(1),bindingsUtils.updateNthPoint(2),bindingsUtils.updateNthPoint(3),bindingsUtils.updateNthPoint(4)]},elliott3:{className:"highcharts-elliott3",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),n=this.utils.getAssignedAxis(i.yAxis);if(s&&n){var e=s.value,t=n.value,i=this.chart.options.navigation,i=merge({langKey:"elliott3",type:"elliottWave",typeOptions:{xAxis:s.axis.options.index,yAxis:n.axis.options.index,points:[{x:e,y:t},{x:e,y:t},{x:e,y:t},{x:e,y:t}]},labelOptions:{style:{color:palette.neutralColor60}}},i.annotationsOptions,i.bindings.elliott3.annotationsOptions);return this.chart.addAnnotation(i)}},steps:[bindingsUtils.updateNthPoint(1),bindingsUtils.updateNthPoint(2),bindingsUtils.updateNthPoint(3)]},elliott5:{className:"highcharts-elliott5",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),n=this.utils.getAssignedAxis(i.yAxis);if(s&&n){var e=s.value,t=n.value,i=this.chart.options.navigation,i=merge({langKey:"elliott5",type:"elliottWave",typeOptions:{xAxis:s.axis.options.index,yAxis:n.axis.options.index,points:[{x:e,y:t},{x:e,y:t},{x:e,y:t},{x:e,y:t},{x:e,y:t},{x:e,y:t}]},labelOptions:{style:{color:palette.neutralColor60}}},i.annotationsOptions,i.bindings.elliott5.annotationsOptions);return this.chart.addAnnotation(i)}},steps:[bindingsUtils.updateNthPoint(1),bindingsUtils.updateNthPoint(2),bindingsUtils.updateNthPoint(3),bindingsUtils.updateNthPoint(4),bindingsUtils.updateNthPoint(5)]},measureX:{className:"highcharts-measure-x",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),n=this.utils.getAssignedAxis(i.yAxis);if(s&&n){var e=s.value,t=n.value,i=this.chart.options.navigation,i=merge({langKey:"measure",type:"measure",typeOptions:{selectType:"x",xAxis:s.axis.options.index,yAxis:n.axis.options.index,point:{x:e,y:t},crosshairX:{strokeWidth:1,stroke:palette.neutralColor100},crosshairY:{enabled:!1,strokeWidth:0,stroke:palette.neutralColor100},background:{width:0,height:0,strokeWidth:0,stroke:palette.backgroundColor}},labelOptions:{style:{color:palette.neutralColor60}}},i.annotationsOptions,i.bindings.measureX.annotationsOptions);return this.chart.addAnnotation(i)}},steps:[bindingsUtils.updateRectSize]},measureY:{className:"highcharts-measure-y",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),n=this.utils.getAssignedAxis(i.yAxis);if(s&&n){var e=s.value,t=n.value,i=this.chart.options.navigation,i=merge({langKey:"measure",type:"measure",typeOptions:{selectType:"y",xAxis:s.axis.options.index,yAxis:n.axis.options.index,point:{x:e,y:t},crosshairX:{enabled:!1,strokeWidth:0,stroke:palette.neutralColor100},crosshairY:{strokeWidth:1,stroke:palette.neutralColor100},background:{width:0,height:0,strokeWidth:0,stroke:palette.backgroundColor}},labelOptions:{style:{color:palette.neutralColor60}}},i.annotationsOptions,i.bindings.measureY.annotationsOptions);return this.chart.addAnnotation(i)}},steps:[bindingsUtils.updateRectSize]},measureXY:{className:"highcharts-measure-xy",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),n=this.utils.getAssignedAxis(i.yAxis);if(s&&n){var e=s.value,t=n.value,i=this.chart.options.navigation,i=merge({langKey:"measure",type:"measure",typeOptions:{selectType:"xy",xAxis:s.axis.options.index,yAxis:n.axis.options.index,point:{x:e,y:t},background:{width:0,height:0,strokeWidth:10},crosshairX:{strokeWidth:1,stroke:palette.neutralColor100},crosshairY:{strokeWidth:1,stroke:palette.neutralColor100}},labelOptions:{style:{color:palette.neutralColor60}}},i.annotationsOptions,i.bindings.measureXY.annotationsOptions);return this.chart.addAnnotation(i)}},steps:[bindingsUtils.updateRectSize]},fibonacci:{className:"highcharts-fibonacci",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),n=this.utils.getAssignedAxis(i.yAxis);if(s&&n){var e=s.value,t=n.value,i=this.chart.options.navigation,i=merge({langKey:"fibonacci",type:"fibonacci",typeOptions:{xAxis:s.axis.options.index,yAxis:n.axis.options.index,points:[{x:e,y:t},{x:e,y:t}]},labelOptions:{style:{color:palette.neutralColor60}}},i.annotationsOptions,i.bindings.fibonacci.annotationsOptions);return this.chart.addAnnotation(i)}},steps:[bindingsUtils.updateNthPoint(1),bindingsUtils.updateHeight]},parallelChannel:{className:"highcharts-parallel-channel",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),n=this.utils.getAssignedAxis(i.yAxis);if(s&&n){var e=s.value,t=n.value,i=this.chart.options.navigation,i=merge({langKey:"parallelChannel",type:"tunnel",typeOptions:{xAxis:s.axis.options.index,yAxis:n.axis.options.index,points:[{x:e,y:t},{x:e,y:t}]}},i.annotationsOptions,i.bindings.parallelChannel.annotationsOptions);return this.chart.addAnnotation(i)}},steps:[bindingsUtils.updateNthPoint(1),bindingsUtils.updateHeight]},pitchfork:{className:"highcharts-pitchfork",start:function(t){var i=this.chart.pointer.getCoordinates(t),s=this.utils.getAssignedAxis(i.xAxis),n=this.utils.getAssignedAxis(i.yAxis);if(s&&n){var e=s.value,t=n.value,i=this.chart.options.navigation,i=merge({langKey:"pitchfork",type:"pitchfork",typeOptions:{xAxis:s.axis.options.index,yAxis:n.axis.options.index,points:[{x:s.value,y:n.value,controlPoint:{style:{fill:palette.negativeColor}}},{x:e,y:t},{x:e,y:t}],innerBackground:{fill:"rgba(100, 170, 255, 0.8)"}},shapeOptions:{strokeWidth:2}},i.annotationsOptions,i.bindings.pitchfork.annotationsOptions);return this.chart.addAnnotation(i)}},steps:[bindingsUtils.updateNthPoint(1),bindingsUtils.updateNthPoint(2)]},verticalCounter:{className:"highcharts-vertical-counter",start:function(t){var i=bindingsUtils.attractToPoint(t,this.chart),t=this.chart.options.navigation;i&&(this.verticalCounter=this.verticalCounter||0,t=merge({langKey:"verticalCounter",type:"verticalLine",typeOptions:{point:{x:i.x,y:i.y,xAxis:i.xAxis,yAxis:i.yAxis},label:{offset:i.below?40:-40,text:this.verticalCounter.toString()}},labelOptions:{style:{color:palette.neutralColor60,fontSize:"11px"}},shapeOptions:{stroke:"rgba(0, 0, 0, 0.75)",strokeWidth:1}},t.annotationsOptions,t.bindings.verticalCounter.annotationsOptions),t=this.chart.addAnnotation(t),this.verticalCounter++,t.options.events.click.call(t,{}))}},verticalLabel:{className:"highcharts-vertical-label",start:function(t){var i=bindingsUtils.attractToPoint(t,this.chart),t=this.chart.options.navigation;i&&(t=merge({langKey:"verticalLabel",type:"verticalLine",typeOptions:{point:{x:i.x,y:i.y,xAxis:i.xAxis,yAxis:i.yAxis},label:{offset:i.below?40:-40}},labelOptions:{style:{color:palette.neutralColor60,fontSize:"11px"}},shapeOptions:{stroke:"rgba(0, 0, 0, 0.75)",strokeWidth:1}},t.annotationsOptions,t.bindings.verticalLabel.annotationsOptions),(t=this.chart.addAnnotation(t)).options.events.click.call(t,{}))}},verticalArrow:{className:"highcharts-vertical-arrow",start:function(t){var i=bindingsUtils.attractToPoint(t,this.chart),t=this.chart.options.navigation;i&&(t=merge({langKey:"verticalArrow",type:"verticalLine",typeOptions:{point:{x:i.x,y:i.y,xAxis:i.xAxis,yAxis:i.yAxis},label:{offset:i.below?40:-40,format:" "},connector:{fill:"none",stroke:i.below?palette.negativeColor:palette.positiveColor}},shapeOptions:{stroke:"rgba(0, 0, 0, 0.75)",strokeWidth:1}},t.annotationsOptions,t.bindings.verticalArrow.annotationsOptions),(t=this.chart.addAnnotation(t)).options.events.click.call(t,{}))}},flagCirclepin:{className:"highcharts-flag-circlepin",start:bindingsUtils.addFlagFromForm("circlepin")},flagDiamondpin:{className:"highcharts-flag-diamondpin",start:bindingsUtils.addFlagFromForm("flag")},flagSquarepin:{className:"highcharts-flag-squarepin",start:bindingsUtils.addFlagFromForm("squarepin")},flagSimplepin:{className:"highcharts-flag-simplepin",start:bindingsUtils.addFlagFromForm("nopin")},zoomX:{className:"highcharts-zoom-x",init:function(t){this.chart.update({chart:{zoomType:"x"}}),fireEvent(this,"deselectButton",{button:t})}},zoomY:{className:"highcharts-zoom-y",init:function(t){this.chart.update({chart:{zoomType:"y"}}),fireEvent(this,"deselectButton",{button:t})}},zoomXY:{className:"highcharts-zoom-xy",init:function(t){this.chart.update({chart:{zoomType:"xy"}}),fireEvent(this,"deselectButton",{button:t})}},seriesTypeLine:{className:"highcharts-series-type-line",init:function(t){this.chart.series[0].update({type:"line",useOhlcData:!0}),fireEvent(this,"deselectButton",{button:t})}},seriesTypeOhlc:{className:"highcharts-series-type-ohlc",init:function(t){this.chart.series[0].update({type:"ohlc"}),fireEvent(this,"deselectButton",{button:t})}},seriesTypeCandlestick:{className:"highcharts-series-type-candlestick",init:function(t){this.chart.series[0].update({type:"candlestick"}),fireEvent(this,"deselectButton",{button:t})}},fullScreen:{className:"highcharts-full-screen",noDataState:"normal",init:function(t){this.chart.fullscreen.toggle(),fireEvent(this,"deselectButton",{button:t})}},currentPriceIndicator:{className:"highcharts-current-price-indicator",init:function(t){var i=this.chart,s=i.series,n=i.stockTools,e=bindingsUtils.isPriceIndicatorEnabled(i.series);n&&n.guiEnabled&&(s.forEach(function(t){t.update({lastPrice:{enabled:!e},lastVisiblePrice:{enabled:!e,label:{enabled:!0}}},!1)}),i.redraw()),fireEvent(this,"deselectButton",{button:t})}},indicators:{className:"highcharts-indicators",init:function(){var i=this;fireEvent(i,"showPopup",{formType:"indicators",options:{},onSubmit:function(t){i.utils.manageIndicators.call(i,t)}})}},toggleAnnotations:{className:"highcharts-toggle-annotations",init:function(t){var i=this.chart,s=i.stockTools,n=s.getIconsURL();this.toggledAnnotations=!this.toggledAnnotations,(i.annotations||[]).forEach(function(t){t.setVisibility(!this.toggledAnnotations)},this),s&&s.guiEnabled&&(this.toggledAnnotations?t.firstChild.style["background-image"]='url("'+n+'annotations-hidden.svg")':t.firstChild.style["background-image"]='url("'+n+'annotations-visible.svg")'),fireEvent(this,"deselectButton",{button:t})}},saveChart:{className:"highcharts-save-chart",noDataState:"normal",init:function(t){var i=this.chart,s=[],n=[],e=[],o=[];i.annotations.forEach(function(t,i){s[i]=t.userOptions}),i.series.forEach(function(t){t.is("sma")?n.push(t.userOptions):"flags"===t.type&&e.push(t.userOptions)}),i.yAxis.forEach(function(t){bindingsUtils.isNotNavigatorYAxis(t)&&o.push(t.options)}),H.win.localStorage.setItem(PREFIX+"chart",JSON.stringify({annotations:s,indicators:n,flags:e,yAxes:o})),fireEvent(this,"deselectButton",{button:t})}}};setOptions({navigation:{bindings:stockToolsBindings}}),NavigationBindings.prototype.utils=merge(bindingsUtils,NavigationBindings.prototype.utils);