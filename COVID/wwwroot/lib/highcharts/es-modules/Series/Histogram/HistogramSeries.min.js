"use strict";var __extends=this&&this.__extends||function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();import DerivedSeriesMixin from"../../Mixins/DerivedSeries.js";import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";var ColumnSeries=SeriesRegistry.seriesTypes.column;import U from"../../Core/Utilities.js";var arrayMax=U.arrayMax,arrayMin=U.arrayMin,correctFloat=U.correctFloat,extend=U.extend,isNumber=U.isNumber,merge=U.merge,objectEach=U.objectEach,binsNumberFormulas={"square-root":function(e){return Math.ceil(Math.sqrt(e.options.data.length))},sturges:function(e){return Math.ceil(Math.log(e.options.data.length)*Math.LOG2E)},rice:function(e){return Math.ceil(2*Math.pow(e.options.data.length,1/3))}};function fitToBinLeftClosed(r){return function(e){for(var t=1;r[t]<=e;)t++;return r[--t]}}var HistogramSeries=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=void 0,e.options=void 0,e.points=void 0,e.userOptions=void 0,e}return __extends(e,t),e.prototype.binsNumber=function(){var e=this.options.binsNumber,t=binsNumberFormulas[e]||"function"==typeof e&&e;return Math.ceil(t&&t(this.baseSeries)||(isNumber(e)?e:binsNumberFormulas["square-root"](this.baseSeries)))},e.prototype.derivedData=function(e,t,r){var i,o,n=this,s=correctFloat(arrayMax(e)),a=correctFloat(arrayMin(e)),u=[],c={},p=[];for(r=n.binWidth=correctFloat(isNumber(r)?r||1:(s-a)/t),n.options.pointRange=Math.max(r,0),i=a;i<s&&(n.userOptions.binWidth||correctFloat(s-i)>=r||correctFloat(correctFloat(a+u.length*r)-i)<=0);i=correctFloat(i+r))u.push(i),c[i]=0;return 0!==c[a]&&(u.push(a),c[a]=0),o=fitToBinLeftClosed(u.map(function(e){return parseFloat(e)})),e.forEach(function(e){e=correctFloat(o(e));c[e]++}),objectEach(c,function(e,t){p.push({x:Number(t),y:e,x2:correctFloat(Number(t)+r)})}),p.sort(function(e,t){return e.x-t.x}),p[p.length-1].x2=s,p},e.prototype.setDerivedData=function(){var e=this.baseSeries.yData;e.length?(e=this.derivedData(e,this.binsNumber(),this.options.binWidth),this.setData(e,!1)):this.setData([])},e.defaultOptions=merge(ColumnSeries.defaultOptions,{binsNumber:"square-root",binWidth:void 0,pointPadding:0,groupPadding:0,grouping:!1,pointPlacement:"between",tooltip:{headerFormat:"",pointFormat:'<span style="font-size: 10px">{point.x} - {point.x2}</span><br/><span style="color:{point.color}">‚óè</span> {series.name} <b>{point.y}</b><br/>'}}),e}(ColumnSeries);extend(HistogramSeries.prototype,{addBaseSeriesEvents:DerivedSeriesMixin.addBaseSeriesEvents,addEvents:DerivedSeriesMixin.addEvents,destroy:DerivedSeriesMixin.destroy,hasDerivedData:DerivedSeriesMixin.hasDerivedData,init:DerivedSeriesMixin.init,setBaseSeries:DerivedSeriesMixin.setBaseSeries}),SeriesRegistry.registerSeriesType("histogram",HistogramSeries);export default HistogramSeries;