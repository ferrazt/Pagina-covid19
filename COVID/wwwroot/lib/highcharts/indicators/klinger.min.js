"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/indicators/klinger",["highcharts","highcharts/modules/stock"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,r,i){t.hasOwnProperty(e)||(t[e]=i.apply(null,r))}e(t=t?t._modules:{},"Mixins/IndicatorRequired.js",[t["Core/Utilities.js"]],function(t){var n=t.error;return{isParentLoaded:function(t,e,r,i,o){return t?!i||i(t):(n(o||this.generateMessage(r,e)),!1)},generateMessage:function(t,e){return'Error: "'+t+'" indicator type requires "'+e+'" indicator loaded before. Please read docs: https://api.highcharts.com/highstock/plotOptions.'+t}}}),e(t,"Mixins/MultipleLines.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(t,e){var l=e.defined,u=e.error,c=e.merge,h=t.seriesTypes.sma;return{pointArrayMap:["top","bottom"],pointValKey:"top",linesApiNames:["bottomLine"],getTranslatedLinesNames:function(e){var r=[];return(this.pointArrayMap||[]).forEach(function(t){t!==e&&r.push("plot"+t.charAt(0).toUpperCase()+t.slice(1))}),r},toYData:function(e){var r=[];return(this.pointArrayMap||[]).forEach(function(t){r.push(e[t])}),r},translate:function(){var i,o=this,t=o.pointArrayMap,n=o.getTranslatedLinesNames();h.prototype.translate.apply(o,arguments),o.points.forEach(function(r){t.forEach(function(t,e){null!==(i=r[t])&&(r[n[e]]=o.yAxis.toPixels(i,!0))})})},drawGraph:function(){var r,i=this,t=i.linesApiNames,o=i.points,n=o.length,a=i.options,e=i.graph,s={options:{gapSize:a.gapSize}},p=[];i.getTranslatedLinesNames(i.pointValKey).forEach(function(t,e){for(p[e]=[];n--;)r=o[n],p[e].push({x:r.x,plotX:r.plotX,plotY:r[t],isNull:!l(r[t])});n=o.length}),t.forEach(function(t,e){p[e]?(i.points=p[e],a[t]?i.options=c(a[t].styles,s):u('Error: "There is no '+t+' in DOCS options declared. Check if linesApiNames are consistent with your DOCS line names." at mixin/multiple-line.js:34'),i.graph=i["graph"+t],h.prototype.drawGraph.call(i),i["graph"+t]=i.graph):u('Error: "'+t+" doesn't have equivalent in pointArrayMap. To many elements in linesApiNames relative to pointArrayMap.\"")}),i.points=o,i.options=a,i.graph=e,h.prototype.drawGraph.call(i)}}}),e(t,"Stock/Indicators/Klinger/KlingerIndicator.js",[t["Mixins/IndicatorRequired.js"],t["Mixins/MultipleLines.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e,r,i){var o,n,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=(u=r.seriesTypes).sma,p=u.ema,v=i.correctFloat,l=i.error,u=i.extend,c=i.isArray,h=i.merge;function d(){var t=null!==n&&n.apply(this,arguments)||this;return t.data=void 0,t.points=void 0,t.options=void 0,t.volumeSeries=void 0,t}return a(d,n=s),d.prototype.init=function(){var e=arguments,r=this;t.isParentLoaded(p,"ema",r.type,function(t){t.prototype.init.apply(r,e)})},d.prototype.calculateTrend=function(t,e){return t[e][1]+t[e][2]+t[e][3]>t[e-1][1]+t[e-1][2]+t[e-1][3]?1:-1},d.prototype.isValidData=function(t){var e=this.chart,r=this.options,i=this.linkedParent;return t=c(t)&&4===t.length,(e=this.volumeSeries||(this.volumeSeries=e.get(r.params.volumeSeriesID)))||l("Series "+r.params.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,i.chart),!(![i,e].every(function(t){return t&&t.xData&&t.xData.length>=r.params.slowAvgPeriod})||!t)},d.prototype.getCM=function(t,e,r,i,o){return v(e+(r===i?t:o))},d.prototype.getDM=function(t,e){return v(t-e)},d.prototype.getVolumeForce=function(t){for(var e=[],r=1,i=0,o=t[0][1]-t[0][2],n=0;r<t.length;r++){var a=this.calculateTrend(t,r),s=this.getDM(t[r][1],t[r][2]),i=this.getCM(i,s,a,n,o),n=this.volumeSeries.yData[r]*a*Math.abs(2*(s/i-1))*100;e.push([n]),n=a,o=s}return e},d.prototype.getEMA=function(t,e,r,i,o,n,a){return p.prototype.calculateEma(a||[],t,void 0===n?1:n,i,e,void 0===o?-1:o,r)},d.prototype.getSMA=function(t,e,r){return p.prototype.accumulatePeriodPoints(t,e,r)/t},d.prototype.getValues=function(t,e){var r=[],i=t.xData;t=t.yData;var o,n=[],a=[],s=[],p=0,l=0,u=void 0,c=void 0,h=null;if(this.isValidData(t[0])){for(var d=this.getVolumeForce(t),g=this.getSMA(e.fastAvgPeriod,0,d),f=this.getSMA(e.slowAvgPeriod,0,d),y=2/(e.fastAvgPeriod+1),m=2/(e.slowAvgPeriod+1);p<t.length;p++)p>=e.fastAvgPeriod&&(u=l=this.getEMA(d,u,g,y,0,p,i)[1]),p>=e.slowAvgPeriod&&(c=o=this.getEMA(d,c,f,m,0,p,i)[1],o=v(l-o),s.push(o),s.length>=e.signalPeriod&&(h=s.slice(-e.signalPeriod).reduce(function(t,e){return t+e})/e.signalPeriod),r.push([i[p],o,h]),n.push(i[p]),a.push([o,h]));return{values:r,xData:n,yData:a}}},d.defaultOptions=h(s.defaultOptions,{params:{fastAvgPeriod:34,slowAvgPeriod:55,signalPeriod:13,volumeSeriesID:"volume"},signalLine:{styles:{lineWidth:1,lineColor:"#ff0000"}},dataGrouping:{approximation:"averages"},tooltip:{pointFormat:'<span style="color: {point.color}">‚óè</span><b> {series.name}</b><br/><span style="color: {point.color}">Klinger</span>: {point.y}<br/><span style="color: {point.series.options.signalLine.styles.lineColor}">Signal</span>: {point.signal}<br/>'}}),u((i=d).prototype,{linesApiNames:["signalLine"],nameBase:"Klinger",nameComponents:["fastAvgPeriod","slowAvgPeriod"],pointArrayMap:["y","signal"],parallelArrays:["x","y","signal"],pointValKey:"y",drawGraph:e.drawGraph,getTranslatedLinesNames:e.getTranslatedLinesNames,translate:e.translate,toYData:e.toYData}),r.registerSeriesType("klinger",i),i}),e(t,"masters/indicators/klinger.src.js",[],function(){})});