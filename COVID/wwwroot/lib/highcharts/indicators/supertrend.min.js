"use strict";!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/indicators/supertrend",["highcharts","highcharts/modules/stock"],function(o){return t(o),t.Highcharts=o,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){function t(o,t,e,r){o.hasOwnProperty(t)||(o[t]=r.apply(null,e))}t(o=o?o._modules:{},"Stock/Indicators/Supertrend/SupertrendIndicator.js",[o["Core/Color/Palette.js"],o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"]],function(o,t,e){function C(o,t,e){return{index:t,close:o.yData[t][e],x:o.xData[t]}}var r,n,i=this&&this.__extends||(r=function(o,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(o,t)},function(o,t){function e(){this.constructor=o}r(o,t),o.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),v=(l=t.seriesTypes).atr,T=l.sma,D=e.correctFloat,S=e.isArray,l=e.extend,_=e.merge,b=e.objectEach;function s(){var o=null!==n&&n.apply(this,arguments)||this;return o.data=void 0,o.linkedParent=void 0,o.options=void 0,o.points=void 0,o}return i(s,n=T),s.prototype.init=function(){T.prototype.init.apply(this,arguments);var o=this.options;o.cropThreshold=this.linkedParent.options.cropThreshold-(o.params.period-1)},s.prototype.drawGraph=function(){for(var o,t,e,r,n,i,l,s,a=this,p=a.options,c=a.linkedParent,d=c?c.points:[],h=a.points,u=a.graph,y=h.length,f=0<(f=d.length-y)?f:0,g={options:{gapSize:p.gapSize}},x={top:[],bottom:[],intersect:[]},m={top:{styles:{lineWidth:p.lineWidth,lineColor:p.fallingTrendColor||p.color,dashStyle:p.dashStyle}},bottom:{styles:{lineWidth:p.lineWidth,lineColor:p.risingTrendColor||p.color,dashStyle:p.dashStyle}},intersect:p.changeTrendLine};y--;)o=h[y],t=h[y-1],e=d[y-1+f],r=d[y-2+f],n=d[y+f],i=d[y+f+1],l=o.options.color,s={x:o.x,plotX:o.plotX,plotY:o.plotY,isNull:!1},!r&&e&&c.yData[e.index-1]&&(r=C(c,e.index-1,3)),!i&&n&&c.yData[n.index+1]&&(i=C(c,n.index+1,3)),!e&&r&&c.yData[r.index+1]?e=C(c,r.index+1,3):!e&&n&&c.yData[n.index-1]&&(e=C(c,n.index-1,3)),o&&e&&n&&r&&o.x!==e.x&&(o.x===n.x?(r=e,e=n):o.x===r.x?(e=r,r={close:c.yData[e.index-1][3],x:c.xData[e.index-1]}):i&&o.x===i.x&&(e=i,r=n)),t&&r&&e?(n={x:t.x,plotX:t.plotX,plotY:t.plotY,isNull:!1},o.y>=e.close&&t.y>=r.close?(o.color=l||p.fallingTrendColor||p.color,x.top.push(s)):o.y<e.close&&t.y<r.close?(o.color=l||p.risingTrendColor||p.color,x.bottom.push(s)):(x.intersect.push(s),x.intersect.push(n),x.intersect.push(_(n,{isNull:!0})),o.y>=e.close&&t.y<r.close?(o.color=l||p.fallingTrendColor||p.color,t.color=l||p.risingTrendColor||p.color,x.top.push(s),x.top.push(_(n,{isNull:!0}))):o.y<e.close&&t.y>=r.close&&(o.color=l||p.risingTrendColor||p.color,t.color=l||p.fallingTrendColor||p.color,x.bottom.push(s),x.bottom.push(_(n,{isNull:!0}))))):e&&(o.y>=e.close?(o.color=l||p.fallingTrendColor||p.color,x.top.push(s)):(o.color=l||p.risingTrendColor||p.color,x.bottom.push(s)));b(x,function(o,t){a.points=o,a.options=_(m[t].styles,g),a.graph=a["graph"+t+"Line"],T.prototype.drawGraph.call(a),a["graph"+t+"Line"]=a.graph}),a.points=h,a.options=p,a.graph=u},s.prototype.getValues=function(o,t){var e=t.period;t=t.multiplier;var r,n=o.xData,i=o.yData,l=[],s=[],a=[],p=0===e?0:e-1,c=[],d=[];if(!(n.length<=e||!S(i[0])||4!==i[0].length||e<0)){for(o=v.prototype.getValues.call(this,o,{period:e}).yData,r=0;r<o.length;r++){var h=i[p+r],u=i[p+r-1]||[],y=c[r-1],f=d[r-1],g=a[r-1];0===r&&(y=f=g=0);var x,e=D((h[1]+h[2])/2+t*o[r]),m=D((h[1]+h[2])/2-t*o[r]);c[r]=e<y||u[3]>y?e:y,d[r]=f<m||u[3]<f?m:f,g===y&&h[3]<c[r]||g===f&&h[3]<d[r]?x=c[r]:(g===y&&h[3]>c[r]||g===f&&h[3]>d[r])&&(x=d[r]),l.push([n[p+r],x]),s.push(n[p+r]),a.push(x)}return{values:l,xData:s,yData:a}}},s.defaultOptions=_(T.defaultOptions,{params:{index:void 0,multiplier:3,period:10},risingTrendColor:o.positiveColor,fallingTrendColor:o.negativeColor,changeTrendLine:{styles:{lineWidth:1,lineColor:o.neutralColor80,dashStyle:"LongDash"}}}),l((e=s).prototype,{nameBase:"Supertrend",nameComponents:["multiplier","period"],requiredIndicators:["atr"]}),t.registerSeriesType("supertrend",e),e}),t(o,"masters/indicators/supertrend.src.js",[],function(){})});