"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/indicators/klinger",["highcharts","highcharts/modules/stock"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){t=t?t._modules:{};function e(t,e,i,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,i))}e(t,"Mixins/IndicatorRequired.js",[t["Core/Utilities.js"]],function(t){var n=t.error;return{isParentLoaded:function(t,e,i,r,o){return t?!r||r(t):(n(o||this.generateMessage(i,e)),!1)},generateMessage:function(t,e){return'Error: "'+t+'" indicator type requires "'+e+'" indicator loaded before. Please read docs: https://api.highcharts.com/highstock/plotOptions.'+t}}}),e(t,"Mixins/MultipleLines.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(t,e){var u=e.defined,c=e.error,h=e.merge,d=t.seriesTypes.sma;return{pointArrayMap:["top","bottom"],pointValKey:"top",linesApiNames:["bottomLine"],getTranslatedLinesNames:function(e){var i=[];return(this.pointArrayMap||[]).forEach(function(t){t!==e&&i.push("plot"+t.charAt(0).toUpperCase()+t.slice(1))}),i},toYData:function(e){var i=[];return(this.pointArrayMap||[]).forEach(function(t){i.push(e[t])}),i},translate:function(){var r,o=this,t=o.pointArrayMap,n=o.getTranslatedLinesNames();d.prototype.translate.apply(o,arguments),o.points.forEach(function(i){t.forEach(function(t,e){null!==(r=i[t])&&(i[n[e]]=o.yAxis.toPixels(r,!0))})})},drawGraph:function(){var i,r=this,t=r.pointValKey,e=r.linesApiNames,o=r.points,n=o.length,a=r.options,s=r.graph,p={options:{gapSize:a.gapSize}},l=[];r.getTranslatedLinesNames(t).forEach(function(t,e){for(l[e]=[];n--;)i=o[n],l[e].push({x:i.x,plotX:i.plotX,plotY:i[t],isNull:!u(i[t])});n=o.length}),e.forEach(function(t,e){l[e]?(r.points=l[e],a[t]?r.options=h(a[t].styles,p):c('Error: "There is no '+t+' in DOCS options declared. Check if linesApiNames are consistent with your DOCS line names." at mixin/multiple-line.js:34'),r.graph=r["graph"+t],d.prototype.drawGraph.call(r),r["graph"+t]=r.graph):c('Error: "'+t+" doesn't have equivalent in pointArrayMap. To many elements in linesApiNames relative to pointArrayMap.\"")}),r.points=o,r.options=a,r.graph=s,d.prototype.drawGraph.call(r)}}}),e(t,"Stock/Indicators/Klinger/KlingerIndicator.js",[t["Mixins/IndicatorRequired.js"],t["Mixins/MultipleLines.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e,i,r){var o,n,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=i.seriesTypes,p=s.sma,l=s.ema,A=r.correctFloat,u=r.error,s=r.extend,c=r.isArray,r=r.merge,p=(a(h,n=p),h.prototype.init=function(){var e=arguments,i=this;t.isParentLoaded(l,"ema",i.type,function(t){t.prototype.init.apply(i,e)})},h.prototype.calculateTrend=function(t,e){return t[e][1]+t[e][2]+t[e][3]>t[e-1][1]+t[e-1][2]+t[e-1][3]?1:-1},h.prototype.isValidData=function(t){var e=this.chart,i=this.options,r=this.linkedParent,t=c(t)&&4===t.length,e=this.volumeSeries||(this.volumeSeries=e.get(i.params.volumeSeriesID));return e||u("Series "+i.params.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,r.chart),!(![r,e].every(function(t){return t&&t.xData&&t.xData.length>=i.params.slowAvgPeriod})||!t)},h.prototype.getCM=function(t,e,i,r,o){return A(e+(i===r?t:o))},h.prototype.getDM=function(t,e){return A(t-e)},h.prototype.getVolumeForce=function(t){for(var e,i,r,o,n=[],a=1,s=0,p=t[0][1]-t[0][2],l=0;a<t.length;a++)o=this.calculateTrend(t,a),i=this.getDM(t[a][1],t[a][2]),e=this.getCM(s,i,o,l,p),r=this.volumeSeries.yData[a]*o*Math.abs(2*(i/e-1))*100,n.push([r]),l=o,s=e,p=i;return n},h.prototype.getEMA=function(t,e,i,r,o,n,a){return l.prototype.calculateEma(a||[],t,void 0===n?1:n,r,e,void 0===o?-1:o,i)},h.prototype.getSMA=function(t,e,i){return l.prototype.accumulatePeriodPoints(t,e,i)/t},h.prototype.getValues=function(t,e){var i,r=[],o=t.xData,n=t.yData,a=[],s=[],p=[],l=0,u=0,c=void 0,h=void 0,d=null;if(this.isValidData(n[0])){for(var g=this.getVolumeForce(n),f=this.getSMA(e.fastAvgPeriod,0,g),y=this.getSMA(e.slowAvgPeriod,0,g),m=2/(e.fastAvgPeriod+1),v=2/(e.slowAvgPeriod+1);l<n.length;l++)l>=e.fastAvgPeriod&&(c=u=this.getEMA(g,c,f,m,0,l,o)[1]),l>=e.slowAvgPeriod&&(i=this.getEMA(g,h,y,v,0,l,o)[1],i=A(u-(h=i)),p.push(i),p.length>=e.signalPeriod&&(d=p.slice(-e.signalPeriod).reduce(function(t,e){return t+e})/e.signalPeriod),r.push([o[l],i,d]),a.push(o[l]),s.push([i,d]));return{values:r,xData:a,yData:s}}},h.defaultOptions=r(p.defaultOptions,{params:{fastAvgPeriod:34,slowAvgPeriod:55,signalPeriod:13,volumeSeriesID:"volume"},signalLine:{styles:{lineWidth:1,lineColor:"#ff0000"}},dataGrouping:{approximation:"averages"},tooltip:{pointFormat:'<span style="color: {point.color}">‚óè</span><b> {series.name}</b><br/><span style="color: {point.color}">Klinger</span>: {point.y}<br/><span style="color: {point.series.options.signalLine.styles.lineColor}">Signal</span>: {point.signal}<br/>'}}),h);function h(){var t=null!==n&&n.apply(this,arguments)||this;return t.data=void 0,t.points=void 0,t.options=void 0,t.volumeSeries=void 0,t}return s(p.prototype,{linesApiNames:["signalLine"],nameBase:"Klinger",nameComponents:["fastAvgPeriod","slowAvgPeriod"],pointArrayMap:["y","signal"],parallelArrays:["x","y","signal"],pointValKey:"y",drawGraph:e.drawGraph,getTranslatedLinesNames:e.getTranslatedLinesNames,translate:e.translate,toYData:e.toYData}),i.registerSeriesType("klinger",p),p}),e(t,"masters/indicators/klinger.src.js",[],function(){})});