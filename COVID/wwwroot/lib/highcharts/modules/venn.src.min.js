"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/venn",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){t=t?t._modules:{};function e(t,e,r,n){t.hasOwnProperty(e)||(t[e]=n.apply(null,r))}e(t,"Mixins/Geometry.js",[],function(){return{getAngleBetweenPoints:function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)},getCenterOfPoints:function(t){var e=t.reduce(function(t,e){return t.x+=e.x,t.y+=e.y,t},{x:0,y:0});return{x:e.x/t.length,y:e.y/t.length}},getDistanceBetweenPoints:function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}}}),e(t,"Mixins/GeometryCircles.js",[t["Mixins/Geometry.js"]],function(t){var u=t.getAngleBetweenPoints,c=t.getCenterOfPoints,l=t.getDistanceBetweenPoints;function f(t,e){e=Math.pow(10,e);return Math.round(t*e)/e}function o(t){if(t<=0)throw new Error("radius of circle must be a positive number.");return Math.PI*t*t}function s(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function a(t,e){var r,n,i,o,s=l(t,e),a=t.r,u=e.r,c=[];return s<a+u&&s>Math.abs(a-u)&&(r=((i=a*a)-u*u+s*s)/(2*s),n=Math.sqrt(i-r*r),o=t.x,a=e.x,t=(u=t.y)+r*((i=e.y)-u)/s,e=n/s*-(a-o),c=[{x:f((o=o+r*(a-o)/s)+(u=n/s*-(i-u)),14),y:f(t-e,14)},{x:f(o-u,14),y:f(t+e,14)}]),c}function r(t){return t.reduce(function(t,i,o,e){e=e.slice(o+1).reduce(function(t,e,r){var n=[o,r+o+1];return t.concat(a(i,e).map(function(t){return t.indexes=n,t}))},[]);return t.concat(e)},[])}function n(t,e){return l(t,e)<=e.r+1e-10}function i(e,t){return!t.some(function(t){return!n(e,t)})}function p(e){return r(e).filter(function(t){return i(t,e)})}return{getAreaOfCircle:o,getAreaOfIntersectionBetweenCircles:function(a){var t,e,r,n=p(a);return 1<n.length&&(e=c(n),r=(n=n.map(function(t){return t.angle=u(e,t),t}).sort(function(t,e){return e.angle-t.angle}))[n.length-1],0===(n=n.reduce(function(t,i){var e,o=t.startPoint,s=c([o,i]),r=i.indexes.filter(function(t){return-1<o.indexes.indexOf(t)}).reduce(function(t,e){var r=a[e],n=u(r,i),e=u(r,o),n=e-(e-n+(e<n?2*Math.PI:0))/2,n=l(s,{x:r.x+r.r*Math.sin(n),y:r.y+r.r*Math.cos(n)}),r=r.r;return 2*r<n&&(n=2*r),t=!t||t.width>n?{r:r,largeArc:r<n?1:0,width:n,x:i.x,y:i.y}:t},null);return r&&(e=r.r,t.arcs.push(["A",e,e,0,r.largeArc,1,r.x,r.y]),t.startPoint=i),t},{startPoint:r,arcs:[]}).arcs).length||1===n.length||(n.unshift(["M",r.x,r.y]),t={center:e,d:n})),t},getCircleCircleIntersection:a,getCirclesIntersectionPoints:r,getCirclesIntersectionPolygon:p,getCircularSegmentArea:s,getOverlapBetweenCircles:function(t,e,r){var n,i=0;return i=r<t+e?f(i=r<=Math.abs(e-t)?o(t<e?t:e):(r=r-(n=(t*t-e*e+r*r)/(2*r)),s(t,t-n)+s(e,e-r)),14):i},isCircle1CompletelyOverlappingCircle2:function(t,e){return l(t,e)+e.r<t.r+1e-10},isPointInsideCircle:n,isPointInsideAllCircles:i,isPointOutsideAllCircles:function(e,t){return!t.some(function(t){return n(e,t)})},round:f}}),e(t,"Mixins/NelderMead.js",[],function(){function h(t){for(var e=t.slice(0,-1),r=e.length,n=[],i=function(t,e){return t.sum+=e[t.i],t},o=0;o<r;o++)n[o]=e.reduce(i,{sum:0,i:o}).sum/r;return n}return{getCentroid:h,nelderMead:function(o,t){for(var e=function(t,e){return t.fx-e.fx},i=function(r,t,n,i){return t.map(function(t,e){return r*t+n*i[e]})},r=function(t,e){return e.fx=o(e),t[t.length-1]=e,t},n=function(t){var e=t[0];return t.map(function(t){t=i(.5,e,.5,t);return t.fx=o(t),t})},s=function(t,e,r,n){e=i(r,t,n,e);return e.fx=o(e),e},a=function(t){var e=t.length,r=new Array(e+1);r[0]=t,r[0].fx=o(t);for(var n=0;n<e;++n){var i=t.slice();i[n]=i[n]?1.05*i[n]:.001,i.fx=o(i),r[n+1]=i}return r}(t),u=0;u<100;u++){a.sort(e);var c,l=a[a.length-1],f=h(a),p=s(f,l,2,-1);a=p.fx<a[0].fx?r(a,(c=s(f,l,3,-2)).fx<p.fx?c:p):p.fx>=a[a.length-2].fx?(c=void 0,p.fx>l.fx?(c=s(f,l,.5,.5)).fx<l.fx?r(a,c):n(a):(c=s(f,l,1.5,-.5)).fx<p.fx?r(a,c):n(a)):r(a,p)}return a[0]}}}),e(t,"Mixins/DrawPoint.js",[],function(){function c(t){return"function"==typeof t}function e(t){var e,r=this,n=t.animatableAttribs,i=t.onComplete,o=t.css,s=t.renderer,a=this.series&&this.series.chart.hasRendered?void 0:this.series&&this.series.options.animation,u=this.graphic;this.shouldDraw()?(u||(this.graphic=u=s[t.shapeType](t.shapeArgs).add(t.group)),u.css(o).attr(t.attribs).animate(n,!t.isNew&&a,i)):u&&(e=function(){r.graphic=u=u&&u.destroy(),c(i)&&i()},Object.keys(n).length?u.animate(n,void 0,function(){e()}):e())}return{draw:e,drawPoint:function(t){(t.attribs=t.attribs||{}).class=this.getClassName(),e.call(this,t)},isFn:c}}),e(t,"Series/Venn/VennPoint.js",[t["Mixins/DrawPoint.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e,r){var n,i,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=e.seriesTypes.scatter,e=r.extend,a=r.isNumber,o=(i=s.prototype.pointClass,o(u,i),u.prototype.isValid=function(){return a(this.value)},u.prototype.shouldDraw=function(){return!!this.shapeArgs},u);function u(){var t=null!==i&&i.apply(this,arguments)||this;return t.options=void 0,t.series=void 0,t}return e(o.prototype,{draw:t.drawPoint}),o}),e(t,"Series/Venn/VennUtils.js",[t["Mixins/GeometryCircles.js"],t["Mixins/Geometry.js"],t["Mixins/NelderMead.js"],t["Core/Utilities.js"]],function(t,e,r,n){var i,o=t.getAreaOfCircle,p=t.getCircleCircleIntersection,s=t.getOverlapBetweenCircles,a=t.isPointInsideAllCircles,u=t.isPointInsideCircle,c=t.isPointOutsideAllCircles,l=e.getDistanceBetweenPoints,f=n.extend,h=n.isArray,d=n.isNumber,y=n.isObject,g=n.isString;function x(t){var r=t.filter(function(t){return 2===t.sets.length}).reduce(function(n,i){return i.sets.forEach(function(t,e,r){y(n[t])||(n[t]={overlapping:{},totalOverlap:0}),n[t].totalOverlap+=i.value,n[t].overlapping[r[1-e]]=i.value}),n},{});return t.filter(C).forEach(function(t){var e=r[t.sets[0]];f(t,e)}),t}function v(t,e,r,n,i){var o,s,a=t(e),u=t(r),c=i||100,l=n||1e-10,f=r-e,p=1;if(r<=e)throw new Error("a must be smaller than b.");if(0<a*u)throw new Error("f(a) and f(b) must have opposite signs.");if(0===a)o=e;else if(0===u)o=r;else for(;p++<=c&&0!==s&&l<f;)0<a*(s=t(o=e+(f=(r-e)/2)))?e=o:r=o;return o}function m(e,r,n){var t=e+r,t=n<=0?t:o(e<r?e:r)<=n?0:v(function(t){t=s(e,r,t);return n-t},0,t);return t}function C(t){return h(t.sets)&&1===t.sets.length}function b(t){var r={};return y(t)&&d(t.value)&&-1<t.value&&h(t.sets)&&0<t.sets.length&&!t.sets.some(function(t){var e=!1;return!r[t]&&g(t)?r[t]=!0:e=!0,e})}function M(o,t){return t.reduce(function(t,e){var r,n,i=0;return 1<e.sets.length&&(n=e.value-(r=e.sets.map(function(t){return o[t]}),n=0,2===r.length&&(e=r[0],r=r[1],n=s(e.r,r.r,l(e,r))),n),i=Math.round(n*n*1e11)/1e11),t+i},0)}function O(t,e){return e.totalOverlap-t.totalOverlap}return(n=i=i||{}).geometry=e,n.geometryCircles=t,n.nelderMead=r,n.addOverlapToSets=x,n.getDistanceBetweenCirclesByOverlap=m,n.getLabelWidth=function(i,o,t){var e=o.reduce(function(t,e){return Math.min(e.r,t)},1/0),s=t.filter(function(t){return!u(i,t)}),t=function(r,n){return v(function(t){var e={x:i.x+n*t,y:i.y},e=a(e,o)&&c(e,s);return-(r-t)+(e?0:Number.MAX_VALUE)},0,r)};return 2*Math.min(t(e,-1),t(e,1))},n.getMarginFromCircles=function(r,t,e){return t=t.reduce(function(t,e){e=e.r-l(r,e);return e<=t?e:t},Number.MAX_VALUE),t=e.reduce(function(t,e){e=l(r,e)-e.r;return e<=t?e:t},t)},n.isSet=C,n.layoutGreedyVenn=function(t){var c=[],l={};function r(t,e){var r=t.circle;r.x=e.x,r.y=e.y,c.push(t)}t.filter(function(t){return 1===t.sets.length}).forEach(function(t){l[t.sets[0]]=t.circle={x:Number.MAX_VALUE,y:Number.MAX_VALUE,r:Math.sqrt(t.value/Math.PI)}}),x(t);var e=t.filter(C).sort(O);r(e.shift(),{x:0,y:0});var f=t.filter(function(t){return 2===t.sets.length});return e.forEach(function(t){var s=t.circle,a=s.r,u=t.overlapping,e=c.reduce(function(r,t,e){var n=t.circle,t=u[t.sets[0]],i=m(a,n.r,t),o=[{x:n.x+i,y:n.y},{x:n.x-i,y:n.y},{x:n.x,y:n.y+i},{x:n.x,y:n.y-i}];return c.slice(e+1).forEach(function(t){var e=t.circle,t=u[t.sets[0]],t=m(a,e.r,t);o=o.concat(p({x:n.x,y:n.y,r:i},{x:e.x,y:e.y,r:t}))}),o.forEach(function(t){s.x=t.x,s.y=t.y;var e=M(l,f);e<r.loss&&(r.loss=e,r.coordinates=t)}),r},{loss:Number.MAX_VALUE,coordinates:void 0});r(t,e.coordinates)}),l},n.loss=M,n.processVennData=function(t){var r=(t=h(t)?t:[]).reduce(function(t,e){var r;return b(r=e)&&C(r)&&0<r.value&&-1===t.indexOf(e.sets[0])&&t.push(e.sets[0]),t},[]).sort(),n=t.reduce(function(t,e){return b(e)&&!e.sets.some(function(t){return-1===r.indexOf(t)})&&(t[e.sets.sort().join()]=e),t},{});return r.reduce(function(e,r,t,n){return n.slice(t+1).forEach(function(t){e.push(r+","+t)}),e},[]).forEach(function(t){var e;n[t]||(e={sets:t.split(","),value:0},n[t]=e)}),Object.keys(n).map(function(t){return n[t]})},n.sortByTotalOverlap=O,i}),e(t,"Series/Venn/VennSeries.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Color/Color.js"],t["Mixins/Geometry.js"],t["Mixins/GeometryCircles.js"],t["Mixins/NelderMead.js"],t["Core/Color/Palette.js"],t["Core/Series/SeriesRegistry.js"],t["Series/Venn/VennPoint.js"],t["Series/Venn/VennUtils.js"],t["Core/Utilities.js"]],function(t,e,r,n,i,o,s,a,p,u){var c,l,f=this&&this.__extends||(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=t.animObject,d=e.parse,y=r.getCenterOfPoints,g=(r.getDistanceBetweenPoints,n.getAreaOfCircle,n.getAreaOfIntersectionBetweenCircles),x=(n.getCircleCircleIntersection,n.getCirclesIntersectionPolygon),v=(n.getOverlapBetweenCircles,n.isCircle1CompletelyOverlappingCircle2),m=n.isPointInsideAllCircles,C=(n.isPointInsideCircle,n.isPointOutsideAllCircles),b=i.nelderMead,M=s.seriesTypes.scatter,i=u.addEvent,O=u.extend,A=u.isArray,w=u.isNumber,P=u.isObject,j=(u.isString,u.merge),o=(f(_,l=M),_.getLabelPosition=function(n,i){var t=n.reduce(function(t,e){var r=e.r/2;return[{x:e.x,y:e.y},{x:e.x+r,y:e.y},{x:e.x-r,y:e.y},{x:e.x,y:e.y+r},{x:e.x,y:e.y-r}].reduce(function(t,e){var r=p.getMarginFromCircles(e,n,i);return t.margin<r&&(t.point=e,t.margin=r),t},t)},{point:void 0,margin:-Number.MAX_VALUE}).point,e=b(function(t){return-p.getMarginFromCircles({x:t[0],y:t[1]},n,i)},[t.x,t.y]),t={x:e[0],y:e[1]};return t=!m(t,n)||!C(t,i)?1<n.length?y(x(n)):{x:n[0].x,y:n[0].y}:t},_.getLabelValues=function(t,e){var r=t.sets,n=e.reduce(function(t,e){return t[-1<r.indexOf(e.sets[0])?"internal":"external"].push(e.circle),t},{internal:[],external:[]});n.external=n.external.filter(function(e){return n.internal.some(function(t){return!v(e,t)})});e=_.getLabelPosition(n.internal,n.external);return{position:e,width:p.getLabelWidth(e,n.internal,n.external)}},_.layout=function(t){var n,i,o={},s={};return 0<t.length&&(n=p.layoutGreedyVenn(t),i=t.filter(p.isSet),t.forEach(function(t){var e=t.sets,r=e.join(),e=p.isSet(t)?n[r]:g(e.map(function(t){return n[t]}));e&&(o[r]=e,s[r]=_.getLabelValues(t,i))})),{mapOfIdToShape:o,mapOfIdToLabelValues:s}},_.getScale=function(t,e,r){var n=r.bottom-r.top,i=r.right-r.left,o=(r.right+r.left)/2,r=(r.top+r.bottom)/2,n=Math.min(0<i?1/i*t:1,0<n?1/n*e:1);return{scale:n,centerX:t/2-o*n,centerY:e/2-r*n}},_.updateFieldBoundaries=function(t,e){var r=e.x-e.r,n=e.x+e.r,i=e.y+e.r,e=e.y-e.r;return(!w(t.left)||t.left>r)&&(t.left=r),(!w(t.right)||t.right<n)&&(t.right=n),(!w(t.top)||t.top>e)&&(t.top=e),(!w(t.bottom)||t.bottom<i)&&(t.bottom=i),t},_.prototype.animate=function(t){var i;t||(i=h(this.options.animation),this.points.forEach(function(t){var e,r,n=t.shapeArgs;t.graphic&&n&&(e={},r={},n.d?e.opacity=.001:(e.r=0,r.r=n.r),t.graphic.attr(e).animate(r,i),n.d&&setTimeout(function(){t&&t.graphic&&t.graphic.animate({opacity:1})},i.duration))},this))},_.prototype.drawPoints=function(){var n=this,i=n.chart,o=n.group,t=n.points||[],s=i.renderer;t.forEach(function(t){var e={zIndex:A(t.sets)?t.sets.length:0},r=t.shapeArgs;i.styledMode||O(e,n.pointAttribs(t,t.state)),t.draw({isNew:!t.graphic,animatableAttribs:r,attribs:e,group:o,renderer:s,shapeType:r&&r.d?"path":"circle"})})},_.prototype.init=function(){M.prototype.init.apply(this,arguments),delete this.opacity},_.prototype.pointAttribs=function(t,e){var r=this.options||{},n=t&&t.options||{},e=e&&r.states[e]||{},e=j(r,{color:t&&t.color},n,e);return{fill:d(e.color).brighten(e.brightness).get(),opacity:e.opacity,stroke:e.borderColor,"stroke-width":e.borderWidth,dashstyle:e.borderDashStyle}},_.prototype.translate=function(){var t=this.chart;this.processedXData=this.xData,this.generatePoints();var e=p.processVennData(this.options.data),e=_.layout(e),a=e.mapOfIdToShape,u=e.mapOfIdToLabelValues,e=Object.keys(a).filter(function(t){t=a[t];return t&&w(t.r)}).reduce(function(t,e){return _.updateFieldBoundaries(t,a[e])},{top:0,bottom:0,left:0,right:0}),e=_.getScale(t.plotWidth,t.plotHeight,e),c=e.scale,l=e.centerX,f=e.centerY;this.points.forEach(function(t){var e,r=A(t.sets)?t.sets:[],n=r.join(),i=a[n],o=u[n]||{},s=o.width,n=o.position,o=t.options&&t.options.dataLabels;i&&(i.r?e={x:l+i.x*c,y:f+i.y*c,r:i.r*c}:i.d&&((i=i.d).forEach(function(t){"M"===t[0]?(t[1]=l+t[1]*c,t[2]=f+t[2]*c):"A"===t[0]&&(t[1]=t[1]*c,t[2]=t[2]*c,t[6]=l+t[6]*c,t[7]=f+t[7]*c)}),e={d:i}),n?(n.x=l+n.x*c,n.y=f+n.y*c):n={},w(s)&&(s=Math.round(s*c))),t.shapeArgs=e,n&&e&&(t.plotX=n.x,t.plotY=n.y),s&&e&&(t.dlOptions=j(!0,{style:{width:s}},P(o,!0)?o:void 0)),t.name=t.options.name||r.join("∩")})},_.defaultOptions=j(M.defaultOptions,{borderColor:o.neutralColor20,borderDashStyle:"solid",borderWidth:1,brighten:0,clip:!1,colorByPoint:!0,dataLabels:{enabled:!0,verticalAlign:"middle",formatter:function(){return this.point.name}},inactiveOtherPoints:!0,marker:!1,opacity:.75,showInLegend:!1,states:{hover:{opacity:1,borderColor:o.neutralColor80},select:{color:o.neutralColor20,borderColor:o.neutralColor100,animation:!1},inactive:{opacity:.075}},tooltip:{pointFormat:"{point.name}: {point.value}"}}),_);function _(){var t=null!==l&&l.apply(this,arguments)||this;return t.data=void 0,t.mapOfIdToRelation=void 0,t.options=void 0,t.points=void 0,t}return O(o.prototype,{axisTypes:[],directTouch:!0,isCartesian:!1,pointArrayMap:["value"],pointClass:a,utils:p}),s.registerSeriesType("venn",o),i(o,"afterSetOptions",function(t){var e=t.options.states;this.is("venn")&&Object.keys(e).forEach(function(t){e[t].halo=!1})}),o}),e(t,"masters/modules/venn.src.js",[],function(){})});